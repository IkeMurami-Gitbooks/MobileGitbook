# Запись траффика iOS

## HTTPs

1. Устанавливаем сертификат перехватывающего прокси (= Burp Suite) на телефон&#x20;
2. Settings > General > Profiles > Install Cert&#x20;
3. Settings > General > About > Certificate Trusted Settings

## Записать весь трафик

```
1. Подключаем iPhone по USB
2. ioreg -p IOUSB -l | grep "USB Serial"
            "USB Serial Number" = "f1a8640ea309e1aed7a170a1e073d7bfd4947421"
3. Create Remote Virtual Interface (RMI) on your MacOS (UDID from previous step):
rvictl -s <UDID>
4. Запускаем WireShark и выбираем интерфейс rvi0
5. Фильтруем трафик как хотим
```

(не проверял) Еще какой-то пример с airport: инструмент для записи трафика с какого-то из каналов: [https://qastack.ru/unix/48671/how-to-put-mac-os-x-wireless-adapter-in-monitor-mode](https://qastack.ru/unix/48671/how-to-put-mac-os-x-wireless-adapter-in-monitor-mode)

## HTTPs + dump tls keys via Frida (BoringSSL)

Запускаем дамп ключей

```
frida -U -n com.apple.WebKit.Networking --codeshare andydavies/ios-tls-keylogger -o bbc-news.keylog
```

Запускаем наше приложение через `rvictl`

После открываем pcap файл со сдампленными ключами:&#x20;

```
wireshark -r bbc-news.pcap -o tls:keylog_file:bbc-news.keylog
```

Или через Wireshark UI: `Preferences > Protocols > TLS > (Pre)-MasterSecret log filename`
