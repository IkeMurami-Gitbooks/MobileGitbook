# Закинуть GApps на эмулятор

## Устанавливаем сервисы Google Play для эмулятора.

1. Скачиваем GApp'сы [http://opengapps.org/](http://opengapps.org/)&#x20;
2. Копируем архив в папку где будете с ней работать и переходим в эту папку в терминале
3.  Распаковываем архив. Создаем скрипт extract.sh Даем ему права на выполнения

    ```
    chmod +x extract.sh
    ```

    сам скрипт:

    ```
    unzip open_gapps-x86_64-9.0-stock-20200403.zip 'Core/*'
    rm Core/setup*
    lzip -d Core/*.lz
    for f in $(ls Core/*.tar); do
    tar -x --strip-components 2 -f $f
    done
    ```
4.  запускаем скрипт

    ```
    sh extract.sh
    ```
5.  если в системе не определена переменная ANDROID\_SDK редактируем профиль

    ```
    nano ~/.bash_profile
    ```
6.  определяем переменные

    ```
    export ANDROID_SDK=$HOME/Library/Android/sdk
    export PATH=$ANDROID_SDK/emulator:$ANDROID_SDK/tools:$PATH
    ```

    и сохраняем
7.  перезапускаем bash

    ```
    . ~/.bash_profile
    ```
8.  стартуем эмулятор

    ```
    $ANDROID_SDK/emulator/emulator @<EMULATOR> -writable-system &
    ```
9.  далее ставим пакеты

    ```
    adb root
    adb remount
    adb push etc /system
    adb push framework /system
    adb push app /system
    adb push priv-app /system
    ```
10. перезапускаем

    ```
    adb shell stop
    adb shell start
    ```

## Решение проблемы синхронизации контактов с Google аккаунтом на эмуляторе

Для решения проблемы синхронизации контактов из Google аккаунта на эмуляторе нужно выполнить следующие шаги:&#x20;

1\) Зайти на [https://opengapps.org](https://opengapps.org) и скачать сервисы.&#x20;

Для скачивания нужной версии сервисов нужно выбрать платформу и версию Android. Варианта сборки pico будет достаточно.&#x20;

2\) Заходим в open\_gapps-\[platform]-\[android version]/Core и распаковываем googlecontactssync-all.tar.

&#x20;В папке googlecontactssync-all/nodpi/app/GoogleContactsSyncAdapter будет лежать нужный нам APK GoogleContactsSyncAdapter.apk.&#x20;

3\) Запускаем эмулятор (обязательно с параметром writable, иначе не получится положить APK сервиса в системную папку). Команду нужно выполнять из $ANDDOID\_HOME/tools:&#x20;

emulator -writable-system -avd \[Emulator name] -no-snapshot-load -qemu

4\) Далее закидываем GoogleContactsSyncAdapter.apk в системную папку :&#x20;

adb remount&#x20;

adb push путь/до/апк/GoogleContactsSyncAdapter.apk /system/priv-app/

5\) Перезапускаем устройство:&#x20;

adb shell stop && adb shell start&#x20;

После перезапуска устройства проблема будет решена.
